# 🍊 데이콘 감귤 착과량 예측 AI 경진대회

## 프로젝트 개요

본 프로젝트는 데이콘에서 주최한 "감귤 착과량 예측 AI 경진대회"의 참여 기록입니다.
제주도의 감귤 농가 데이터를 활용하여 나무의 착과량(열매 개수)을 예측하는 머신러닝 모델을 개발하고, 이를 통해 농가의 수확량 예측 및 생산 관리 효율성 증대에 기여하고자 합니다.

**경진대회 링크:** [데이콘 감귤 착과량 예측 AI 경진대회](https://dacon.io/competitions/official/236038/overview/description) 

## 분석 과정

### 1. 데이터 탐색 (EDA) 및 전처리

-   **데이터 로드 및 기본 확인:**
    -   `train.csv`, `test.csv`, `sample_submission.csv` (존재 시) 파일을 로드하여 데이터의 기본 구조와 타입을 파악했습니다.
    -   전체 데이터는 2207개의 학습 샘플과 183개의 초기 피처(ID 제외 시)로 구성되어 있으며, 결측치는 존재하지 않았습니다.
-   **주요 변수 분석:**
    -   **착과량(Target):** 평균 약 406개, 최소 1개에서 최대 799개까지 넓은 분포를 보였습니다.
    -   **나무 생육 정보:** 수고, 수관폭 등의 변수는 이상치가 일부 존재하며, 대체로 정규분포에 가까운 형태를 보였습니다.
    -   **새순 길이 및 엽록소:** 89일간의 일별 측정 데이터로, 시간에 따른 변화 패턴을 분석했습니다.
-   **착과량 상위/하위 그룹 비교 분석:**
    -   착과량 기준으로 상위 25% 그룹과 하위 25% 그룹을 나누어 나무 정보, 새순 길이, 엽록소 데이터의 경향성을 비교 분석했습니다.
    -   **새순 길이:** 초기(9월)에는 하위 그룹의 새순이 길었으나, 후기(11월)로 갈수록 상위 그룹의 새순 길이가 더 길거나 감소폭이 적은 경향을 보였습니다. 특히 하위 그룹은 11월 중순 이후 새순 길이가 급격히 감소했습니다.
    -   **엽록소:** 두 그룹 간 엽록소 수치 및 변화 패턴에 큰 차이가 관찰되지 않았습니다.
-   **이상치 처리:** EDA 결과를 바탕으로 일부 수치형 변수에 대해 이상치 처리(제거 또는 조정)를 고려했습니다. (보고서 기반 추정)
-   **상관관계 분석:**
    -   착과량과 상관관계가 높은 변수는 주로 9월 초중순부터 11월 초까지의 새순 길이 데이터였습니다.
    -   엽록소 및 나무 생육 정보는 상대적으로 낮은 상관성을 보였습니다.

### 2. 피처 엔지니어링

-   **피처 선택:**
    -   **`feature_1` (상관관계 기반):** 착과량과의 상관계수 절대값이 0.85 이상인 새순 관련 변수들을 선택하여 구성했습니다. (총 69개)
-   **파생 변수 생성:**
    -   **`feature_2` (요약 통계량 기반):**
        -   **나무 정보:** `수고/수관폭(max)`, `수관폭(dif)` 생성
        -   **새순/엽록소 (주간 단위):** 7일 단위로 구간을 나누어 각 구간별 평균, 최소, 최대, 합계 값을 생성했습니다.
        -   **새순/엽록소 (전체 기간):** 전체 측정 기간에 대한 평균, 분산, 표준편차 값을 생성했습니다.
-   **불필요셔 ID 컬럼 제거:** 모델 학습에 사용되지 않는 ID 컬럼을 제거했습니다.

### 3. 모델링

-   **데이터 분할:** 학습 데이터와 테스트 데이터를 7:3 비율로 분할하고, `random_state=1`로 고정하여 실험의 재현성을 확보했습니다.
-   **개별 모델 학습:**
    -   **RandomForestRegressor (`rf_model`):**
        -   입력 피처: `feature_1` (상관관계 기반 선택 피처)
        -   주요 하이퍼파라미터: `n_estimators=500`, `max_depth=5`, `max_features=15`
    -   **XGBRegressor (`xgb_model`):**
        -   입력 피처: `feature_2` (파생 변수 포함 피처)
        -   주요 하이퍼파라미터: `learning_rate=0.066`, `n_estimators=4` (또는 `n_estimate`의 오타), `max_depth=2`, `subsample=0.7`, `colsample_bytree=0.5`
-   **스태킹 (Stacking) 앙상블:**
    -   1단계 모델: 위에서 학습한 `rf_model`과 `xgb_model`의 예측값을 사용했습니다.
    -   2단계 메타 모델(Meta-learner): **RandomForestRegressor (`meta_model`)**
        -   주요 하이퍼파라미터: `n_estimators=1000`, `max_depth=25`, `max_features=0.65`

### 4. 모델 평가 (학습 데이터셋 기준)

| 모델 종류             | 입력 피처    | MSE (Mean Squared Error) |
| :-------------------- | :----------- | :----------------------- |
| RandomForestRegressor | `feature_1`  | 1375.08                  |
| XGBRegressor          | `feature_2`  | 1472.97                  |
| **스태킹 모델** | 개별 모델 예측값 | **228.93** |

스태킹 앙상블 모델이 개별 모델에 비해 현저히 낮은 MSE 값을 보여 가장 우수한 성능을 나타냈습니다.

## 5. 결과 요약 및 결론

-   본 프로젝트에서는 다양한 피처 엔지니어링 기법과 스태킹 앙상블 모델을 활용하여 감귤 착과량 예측 모델을 성공적으로 개발했습니다.
-   EDA를 통해 새순 길이 데이터가 착과량 예측에 중요한 변수임을 확인했으며, 이를 바탕으로 상관관계 기반 피처 선택 및 요약 통계량 기반 파생 변수 생성을 수행했습니다.
-   개별 모델(RandomForest, XGBoost)보다 이들의 예측값을 활용한 스태킹 모델이 월등히 낮은 MSE(228.93)를 기록하며 가장 우수한 성능을 보였습니다.

## 6. 향후 개선 방향

-   **하이퍼파라미터 최적화:** GridSearchCV, RandomizedSearchCV, Bayesian Optimization 등을 활용하여 개별 모델 및 메타 모델의 하이퍼파라미터를 튜닝하여 나은 성능을 도모할 수 있으리라 생각합니다.
-   **시간적 특성 심화 분석:** 새순 및 엽록소 데이터의 시계열적 특성을 보다 적극적으로 활용하는 피처(예: 변화율, 이동평균, 계절성 분해 등)를 생성하거나 시계열 모델을 접목하여 개선할 수 있을 것 같습니다 향후 더 공부하여 적용해보도록 하겠습니다.

---
